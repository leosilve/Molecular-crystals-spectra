<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.15"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Molecular-crystals-spectra: lattice&lt; LATFLOAT &gt; Class Template Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">Molecular-crystals-spectra
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.15 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#pub-methods">Public Member Functions</a> &#124;
<a href="#pro-methods">Protected Member Functions</a> &#124;
<a href="#pro-attribs">Protected Attributes</a> &#124;
<a href="classlattice-members.html">List of all members</a>  </div>
  <div class="headertitle">
<div class="title">lattice&lt; LATFLOAT &gt; Class Template Reference</div>  </div>
</div><!--header-->
<div class="contents">

<p>Molecular crystal's lattice.  
 <a href="classlattice.html#details">More...</a></p>

<p><code>#include &lt;<a class="el" href="lattice_8h_source.html">lattice.h</a>&gt;</code></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pub-methods"></a>
Public Member Functions</h2></td></tr>
<tr class="memitem:a0e003a4d97004dd6fadfea47f75fd4f7"><td class="memItemLeft" align="right" valign="top"><a id="a0e003a4d97004dd6fadfea47f75fd4f7"></a>
&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classlattice.html#a0e003a4d97004dd6fadfea47f75fd4f7">lattice</a> (std::string input_file)</td></tr>
<tr class="memdesc:a0e003a4d97004dd6fadfea47f75fd4f7"><td class="mdescLeft">&#160;</td><td class="mdescRight">Reads lattice data from file. <br /></td></tr>
<tr class="separator:a0e003a4d97004dd6fadfea47f75fd4f7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa780b1651fad043a1ff4e4f93e0bcab3"><td class="memItemLeft" align="right" valign="top"><a id="aa780b1651fad043a1ff4e4f93e0bcab3"></a>
int&#160;</td><td class="memItemRight" valign="bottom"><b>get_N_MOL</b> () const</td></tr>
<tr class="separator:aa780b1651fad043a1ff4e4f93e0bcab3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a33eff3e285abb256c37669dba92dc7d1"><td class="memItemLeft" align="right" valign="top"><a id="a33eff3e285abb256c37669dba92dc7d1"></a>
LATFLOAT&#160;</td><td class="memItemRight" valign="bottom"><b>get_VCELL</b> () const</td></tr>
<tr class="separator:a33eff3e285abb256c37669dba92dc7d1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a31163d74251ba664d9640fd4002b389b"><td class="memItemLeft" align="right" valign="top"><a id="a31163d74251ba664d9640fd4002b389b"></a>
int&#160;</td><td class="memItemRight" valign="bottom"><b>get_N_SP</b> () const</td></tr>
<tr class="separator:a31163d74251ba664d9640fd4002b389b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac8c527f7542f71e94a3b5a6a515c2a91"><td class="memItemLeft" align="right" valign="top"><a id="ac8c527f7542f71e94a3b5a6a515c2a91"></a>
int&#160;</td><td class="memItemRight" valign="bottom"><b>get_N_SYM_OP</b> () const</td></tr>
<tr class="separator:ac8c527f7542f71e94a3b5a6a515c2a91"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3d1ed412135db7f5d104d0b90e9a08ff"><td class="memItemLeft" align="right" valign="top"><a id="a3d1ed412135db7f5d104d0b90e9a08ff"></a>
Matrix&#160;</td><td class="memItemRight" valign="bottom"><b>get_epsilon_0</b> () const</td></tr>
<tr class="separator:a3d1ed412135db7f5d104d0b90e9a08ff"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a62f2a1aa4fd21d05e45859742991e008"><td class="memItemLeft" align="right" valign="top"><a id="a62f2a1aa4fd21d05e45859742991e008"></a>
std::string&#160;</td><td class="memItemRight" valign="bottom"><b>get_lattice_name</b> () const</td></tr>
<tr class="separator:a62f2a1aa4fd21d05e45859742991e008"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9914ccd3551a250f7ae3f3aec9406781"><td class="memItemLeft" align="right" valign="top"><a id="a9914ccd3551a250f7ae3f3aec9406781"></a>
std::vector&lt; Vector &gt;&#160;</td><td class="memItemRight" valign="bottom"><b>get_KCELL</b> () const</td></tr>
<tr class="separator:a9914ccd3551a250f7ae3f3aec9406781"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:adb894d21f6583cf6c5a0e991b6b567dc"><td class="memItemLeft" align="right" valign="top"><a id="adb894d21f6583cf6c5a0e991b6b567dc"></a>
std::vector&lt; Vector &gt;&#160;</td><td class="memItemRight" valign="bottom"><b>get_CELL</b> () const</td></tr>
<tr class="separator:adb894d21f6583cf6c5a0e991b6b567dc"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a22ffdc354934e21b23accf03554df38f"><td class="memItemLeft" align="right" valign="top"><a id="a22ffdc354934e21b23accf03554df38f"></a>
Matrix&#160;</td><td class="memItemRight" valign="bottom"><b>get_OtoF</b> () const</td></tr>
<tr class="separator:a22ffdc354934e21b23accf03554df38f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac2b7527d387e4f094ee130971e57f597"><td class="memItemLeft" align="right" valign="top"><a id="ac2b7527d387e4f094ee130971e57f597"></a>
int&#160;</td><td class="memItemRight" valign="bottom"><b>get_NN_size</b> () const</td></tr>
<tr class="separator:ac2b7527d387e4f094ee130971e57f597"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aebd8d869ee6eb5f798012cb849f13ffa"><td class="memItemLeft" align="right" valign="top"><a id="aebd8d869ee6eb5f798012cb849f13ffa"></a>
int&#160;</td><td class="memItemRight" valign="bottom"><b>get_NN_size</b> (int i) const</td></tr>
<tr class="separator:aebd8d869ee6eb5f798012cb849f13ffa"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae6ba2397d79232a312a4ffa29b0f8348"><td class="memItemLeft" align="right" valign="top"><a id="ae6ba2397d79232a312a4ffa29b0f8348"></a>
Vector&#160;</td><td class="memItemRight" valign="bottom"><b>get_KLIGHT</b> () const</td></tr>
<tr class="separator:ae6ba2397d79232a312a4ffa29b0f8348"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa2902ea1babf0a36c85e1eaeb139ca36"><td class="memItemLeft" align="right" valign="top"><a id="aa2902ea1babf0a36c85e1eaeb139ca36"></a>
<a class="el" href="classsym__op.html">sym_op</a>&lt; LATFLOAT &gt;&#160;</td><td class="memItemRight" valign="bottom"><b>get_SYM</b> (int i) const</td></tr>
<tr class="separator:aa2902ea1babf0a36c85e1eaeb139ca36"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5120e872f615f336ab1a59e6ca2998a9"><td class="memItemLeft" align="right" valign="top"><a id="a5120e872f615f336ab1a59e6ca2998a9"></a>
Vector&#160;</td><td class="memItemRight" valign="bottom"><b>get_RHO</b> (int i) const</td></tr>
<tr class="separator:a5120e872f615f336ab1a59e6ca2998a9"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3e1ccf935581cb45ba061fbecfa4ab2d"><td class="memItemLeft" align="right" valign="top"><a id="a3e1ccf935581cb45ba061fbecfa4ab2d"></a>
Vector&#160;</td><td class="memItemRight" valign="bottom"><b>get_MOL_DIPOLE</b> (int i) const</td></tr>
<tr class="separator:a3e1ccf935581cb45ba061fbecfa4ab2d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab1479423e85867d5b45a9e98af8ea395"><td class="memItemLeft" align="right" valign="top"><a id="ab1479423e85867d5b45a9e98af8ea395"></a>
int&#160;</td><td class="memItemRight" valign="bottom"><b>get_ATOM_size</b> () const</td></tr>
<tr class="separator:ab1479423e85867d5b45a9e98af8ea395"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8ae122cbe742b287bb13a5e2e4d4c3fc"><td class="memItemLeft" align="right" valign="top"><a id="a8ae122cbe742b287bb13a5e2e4d4c3fc"></a>
int&#160;</td><td class="memItemRight" valign="bottom"><b>get_ATOM_size</b> (int i) const</td></tr>
<tr class="separator:a8ae122cbe742b287bb13a5e2e4d4c3fc"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa2305806ef94407a1e99b504872db506"><td class="memItemLeft" align="right" valign="top"><a id="aa2305806ef94407a1e99b504872db506"></a>
Vector&#160;</td><td class="memItemRight" valign="bottom"><b>get_ATOM</b> (int alpha, int i) const</td></tr>
<tr class="separator:aa2305806ef94407a1e99b504872db506"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af24d0fd004477df1605ebda0a27d09a1"><td class="memItemLeft" align="right" valign="top"><a id="af24d0fd004477df1605ebda0a27d09a1"></a>
LATFLOAT&#160;</td><td class="memItemRight" valign="bottom"><b>get_CHARGE</b> (int alpha, int i) const</td></tr>
<tr class="separator:af24d0fd004477df1605ebda0a27d09a1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a03988a20a62f0235fd647f79e036b90f"><td class="memItemLeft" align="right" valign="top"><a id="a03988a20a62f0235fd647f79e036b90f"></a>
Vector&#160;</td><td class="memItemRight" valign="bottom"><b>get_CELL</b> (int i) const</td></tr>
<tr class="separator:a03988a20a62f0235fd647f79e036b90f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a74161b154c414130898830c82c8df359"><td class="memItemLeft" align="right" valign="top"><a id="a74161b154c414130898830c82c8df359"></a>
Vector&#160;</td><td class="memItemRight" valign="bottom"><b>get_KCELL</b> (int i) const</td></tr>
<tr class="separator:a74161b154c414130898830c82c8df359"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9038d28315e6c1dd63349018cfee79ab"><td class="memItemLeft" align="right" valign="top"><a id="a9038d28315e6c1dd63349018cfee79ab"></a>
std::vector&lt; <a class="el" href="structpos.html">pos</a>&lt; LATFLOAT &gt; &gt;&#160;</td><td class="memItemRight" valign="bottom"><b>get_NN</b> (int i) const</td></tr>
<tr class="separator:a9038d28315e6c1dd63349018cfee79ab"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8672d60361521ab645082f8632b45636"><td class="memItemLeft" align="right" valign="top"><a id="a8672d60361521ab645082f8632b45636"></a>
<a class="el" href="structpos.html">pos</a>&lt; LATFLOAT &gt;&#160;</td><td class="memItemRight" valign="bottom"><b>get_NN</b> (int i, int j) const</td></tr>
<tr class="separator:a8672d60361521ab645082f8632b45636"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa4c1e1a2ef0c1cccf441ac76ffad4727"><td class="memItemLeft" align="right" valign="top"><a id="aa4c1e1a2ef0c1cccf441ac76ffad4727"></a>
int&#160;</td><td class="memItemRight" valign="bottom"><b>get_NN_alpha</b> (int i, int j) const</td></tr>
<tr class="separator:aa4c1e1a2ef0c1cccf441ac76ffad4727"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9426261d01b602fd7c8bc9eaab359559"><td class="memItemLeft" align="right" valign="top"><a id="a9426261d01b602fd7c8bc9eaab359559"></a>
Vector&#160;</td><td class="memItemRight" valign="bottom"><b>get_NN_n</b> (int i, int j) const</td></tr>
<tr class="separator:a9426261d01b602fd7c8bc9eaab359559"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa3333998fc7a32cae88fb131698db683"><td class="memItemLeft" align="right" valign="top"><a id="aa3333998fc7a32cae88fb131698db683"></a>
LATFLOAT&#160;</td><td class="memItemRight" valign="bottom"><b>get_epsilon_0</b> (int i, int j) const</td></tr>
<tr class="separator:aa3333998fc7a32cae88fb131698db683"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a845c5c8ae72a4c006d9f854b78728d3c"><td class="memItemLeft" align="right" valign="top"><a id="a845c5c8ae72a4c006d9f854b78728d3c"></a>
void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classlattice.html#a845c5c8ae72a4c006d9f854b78728d3c">print</a> (std::ofstream &amp;log_file)</td></tr>
<tr class="memdesc:a845c5c8ae72a4c006d9f854b78728d3c"><td class="mdescLeft">&#160;</td><td class="mdescRight">Prints information about the lattice to file. <br /></td></tr>
<tr class="separator:a845c5c8ae72a4c006d9f854b78728d3c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a99707d13ea060f684ca81f1b9eea38c1"><td class="memItemLeft" align="right" valign="top">std::vector&lt; std::vector&lt; <a class="el" href="structpos.html">pos</a>&lt; LATFLOAT &gt; &gt; &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classlattice.html#a99707d13ea060f684ca81f1b9eea38c1">compute_NN</a> (LATFLOAT rmax, int flag_2D)</td></tr>
<tr class="memdesc:a99707d13ea060f684ca81f1b9eea38c1"><td class="mdescLeft">&#160;</td><td class="mdescRight">Computes the nearest neighbours for each inequivalent molecule.  <a href="#a99707d13ea060f684ca81f1b9eea38c1">More...</a><br /></td></tr>
<tr class="separator:a99707d13ea060f684ca81f1b9eea38c1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0336e996d2d52e3fae5c759adab486e1"><td class="memItemLeft" align="right" valign="top">LATFLOAT&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classlattice.html#a0336e996d2d52e3fae5c759adab486e1">interaction</a> (int alpha, int beta, Vector dr)</td></tr>
<tr class="memdesc:a0336e996d2d52e3fae5c759adab486e1"><td class="mdescLeft">&#160;</td><td class="mdescRight">Calculates the interaction between molecules of type alpha and beta at a distance dr (3D vector)  <a href="#a0336e996d2d52e3fae5c759adab486e1">More...</a><br /></td></tr>
<tr class="separator:a0336e996d2d52e3fae5c759adab486e1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:afc681f628f7d71a76dc260133d00974f"><td class="memItemLeft" align="right" valign="top">LATFLOAT&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classlattice.html#afc681f628f7d71a76dc260133d00974f">interaction</a> (int alpha, int nn)</td></tr>
<tr class="memdesc:afc681f628f7d71a76dc260133d00974f"><td class="mdescLeft">&#160;</td><td class="mdescRight">Calculates the interaction between a molecule of type alpha and its nn-th nearest neighboour.  <a href="#afc681f628f7d71a76dc260133d00974f">More...</a><br /></td></tr>
<tr class="separator:afc681f628f7d71a76dc260133d00974f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a582cd362b494beccb79b905945b2ed48"><td class="memItemLeft" align="right" valign="top">Complex&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classlattice.html#a582cd362b494beccb79b905945b2ed48">compute_Ltilde</a> (Vector kvec, int i, int j, int flag_macro)</td></tr>
<tr class="memdesc:a582cd362b494beccb79b905945b2ed48"><td class="mdescLeft">&#160;</td><td class="mdescRight">Calculates the resonance-interaction matrix using the method defined by "MODE".  <a href="#a582cd362b494beccb79b905945b2ed48">More...</a><br /></td></tr>
<tr class="separator:a582cd362b494beccb79b905945b2ed48"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:acec21c3beec5c95a45c30341bd54e94d"><td class="memItemLeft" align="right" valign="top"><a id="acec21c3beec5c95a45c30341bd54e94d"></a>
void&#160;</td><td class="memItemRight" valign="bottom"><b>computes_lattice_bands</b> (std::string &amp;band_input_file)</td></tr>
<tr class="separator:acec21c3beec5c95a45c30341bd54e94d"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pro-methods"></a>
Protected Member Functions</h2></td></tr>
<tr class="memitem:a808ca53c25c93900e76d3f4623900c6b"><td class="memItemLeft" align="right" valign="top"><a id="a808ca53c25c93900e76d3f4623900c6b"></a>
Vector&#160;</td><td class="memItemRight" valign="bottom"><b>FracToOrth</b> (Vector frac_vec)</td></tr>
<tr class="separator:a808ca53c25c93900e76d3f4623900c6b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac6068ecc1d23c9c6d94920b4f612aa72"><td class="memItemLeft" align="right" valign="top"><a id="ac6068ecc1d23c9c6d94920b4f612aa72"></a>
Vector&#160;</td><td class="memItemRight" valign="bottom"><b>OrthToFrac</b> (Vector orth_vec)</td></tr>
<tr class="separator:ac6068ecc1d23c9c6d94920b4f612aa72"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1343d8f62f0b53645d3c975cb008b0c6"><td class="memItemLeft" align="right" valign="top"><a id="a1343d8f62f0b53645d3c975cb008b0c6"></a>
Vector&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classlattice.html#a1343d8f62f0b53645d3c975cb008b0c6">move_into_primitive_cell_orth</a> (Vector orth_vec)</td></tr>
<tr class="memdesc:a1343d8f62f0b53645d3c975cb008b0c6"><td class="mdescLeft">&#160;</td><td class="mdescRight">Initialises the lattice from input file. <br /></td></tr>
<tr class="separator:a1343d8f62f0b53645d3c975cb008b0c6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a93bf7ce0cf1817549be7748c839e1348"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classlattice.html#a93bf7ce0cf1817549be7748c839e1348">initialize</a> (std::string input_file)</td></tr>
<tr class="memdesc:a93bf7ce0cf1817549be7748c839e1348"><td class="mdescLeft">&#160;</td><td class="mdescRight">Calculates the resonance interaction matrix using Ewald sums.  <a href="#a93bf7ce0cf1817549be7748c839e1348">More...</a><br /></td></tr>
<tr class="separator:a93bf7ce0cf1817549be7748c839e1348"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a386afc85f5649e57b2c108bf043f2081"><td class="memItemLeft" align="right" valign="top"><a id="a386afc85f5649e57b2c108bf043f2081"></a>
Complex&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classlattice.html#a386afc85f5649e57b2c108bf043f2081">Ewald_sums</a> (Vector k, int alpha, int beta, int flag_macro)</td></tr>
<tr class="memdesc:a386afc85f5649e57b2c108bf043f2081"><td class="mdescLeft">&#160;</td><td class="mdescRight">Calculates the resonance interaction matrix using finite sums Used when MODE='F' or MODE='S' Note: flag_2D is not used! <br /></td></tr>
<tr class="separator:a386afc85f5649e57b2c108bf043f2081"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae5f2cf7f125b68ad18c7c952abbe22c1"><td class="memItemLeft" align="right" valign="top">Complex&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classlattice.html#ae5f2cf7f125b68ad18c7c952abbe22c1">Finite_sums</a> (int flag_2D, Vector k, int alpha, int beta)</td></tr>
<tr class="memdesc:ae5f2cf7f125b68ad18c7c952abbe22c1"><td class="mdescLeft">&#160;</td><td class="mdescRight">Calculates the correction to Ewald sums due to transition charge distributions replacing single dipoles.  <a href="#ae5f2cf7f125b68ad18c7c952abbe22c1">More...</a><br /></td></tr>
<tr class="separator:ae5f2cf7f125b68ad18c7c952abbe22c1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7c291d2a723a959f401f599d3a07b981"><td class="memItemLeft" align="right" valign="top"><a id="a7c291d2a723a959f401f599d3a07b981"></a>
Complex&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classlattice.html#a7c291d2a723a959f401f599d3a07b981">Correction_to_Ewald_sums</a> (Vector k, int alpha, int beta)</td></tr>
<tr class="memdesc:a7c291d2a723a959f401f599d3a07b981"><td class="mdescLeft">&#160;</td><td class="mdescRight">Computes free exciton bands along given directions. <br /></td></tr>
<tr class="separator:a7c291d2a723a959f401f599d3a07b981"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5897223ed8d427efd481d88bbcb1bd40"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classlattice.html#a5897223ed8d427efd481d88bbcb1bd40">compute_FE_bands</a> (std::vector&lt; Vector &gt; dir, int npoints, int n0, int n1, int n2, int flag_macro)</td></tr>
<tr class="memdesc:a5897223ed8d427efd481d88bbcb1bd40"><td class="mdescLeft">&#160;</td><td class="mdescRight">Calculates the interaction between transition charge distributions.  <a href="#a5897223ed8d427efd481d88bbcb1bd40">More...</a><br /></td></tr>
<tr class="separator:a5897223ed8d427efd481d88bbcb1bd40"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad3cac006933863ca1733b92af2b12947"><td class="memItemLeft" align="right" valign="top">LATFLOAT&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classlattice.html#ad3cac006933863ca1733b92af2b12947">distributed_charge_interaction</a> (int alpha, int beta, Vector rba)</td></tr>
<tr class="memdesc:ad3cac006933863ca1733b92af2b12947"><td class="mdescLeft">&#160;</td><td class="mdescRight">Calculates the screened interaction between transition charge distributions.  <a href="#ad3cac006933863ca1733b92af2b12947">More...</a><br /></td></tr>
<tr class="separator:ad3cac006933863ca1733b92af2b12947"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3c783dd5a92deb1c488f8446a960e27b"><td class="memItemLeft" align="right" valign="top"><a id="a3c783dd5a92deb1c488f8446a960e27b"></a>
LATFLOAT&#160;</td><td class="memItemRight" valign="bottom"><b>screened_distributed_charge_interaction</b> (int alpha, int beta, Vector rba, LATFLOAT e00, LATFLOAT e11, LATFLOAT e22)</td></tr>
<tr class="separator:a3c783dd5a92deb1c488f8446a960e27b"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pro-attribs"></a>
Protected Attributes</h2></td></tr>
<tr class="memitem:ac4294e3a76c8a74c66d592ffaddc84f2"><td class="memItemLeft" align="right" valign="top"><a id="ac4294e3a76c8a74c66d592ffaddc84f2"></a>
int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classlattice.html#ac4294e3a76c8a74c66d592ffaddc84f2">N_MOL</a></td></tr>
<tr class="memdesc:ac4294e3a76c8a74c66d592ffaddc84f2"><td class="mdescLeft">&#160;</td><td class="mdescRight">Number of molecules per cell. <br /></td></tr>
<tr class="separator:ac4294e3a76c8a74c66d592ffaddc84f2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a106e7ad5bb6de7f628dcd0f1b4c0b5ab"><td class="memItemLeft" align="right" valign="top"><a id="a106e7ad5bb6de7f628dcd0f1b4c0b5ab"></a>
int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classlattice.html#a106e7ad5bb6de7f628dcd0f1b4c0b5ab">N_SP</a></td></tr>
<tr class="memdesc:a106e7ad5bb6de7f628dcd0f1b4c0b5ab"><td class="mdescLeft">&#160;</td><td class="mdescRight">Number of crystallographic species. <br /></td></tr>
<tr class="separator:a106e7ad5bb6de7f628dcd0f1b4c0b5ab"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a91edca1f4b0f2a03952424fc98037476"><td class="memItemLeft" align="right" valign="top"><a id="a91edca1f4b0f2a03952424fc98037476"></a>
int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classlattice.html#a91edca1f4b0f2a03952424fc98037476">N_SYM_OP</a></td></tr>
<tr class="memdesc:a91edca1f4b0f2a03952424fc98037476"><td class="mdescLeft">&#160;</td><td class="mdescRight">Number of symmetry operations. <br /></td></tr>
<tr class="separator:a91edca1f4b0f2a03952424fc98037476"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1afa7ed5b43a996e0c7487adf39b3c8a"><td class="memItemLeft" align="right" valign="top"><a id="a1afa7ed5b43a996e0c7487adf39b3c8a"></a>
std::string&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classlattice.html#a1afa7ed5b43a996e0c7487adf39b3c8a">lattice_name</a></td></tr>
<tr class="memdesc:a1afa7ed5b43a996e0c7487adf39b3c8a"><td class="mdescLeft">&#160;</td><td class="mdescRight">Name used for the lattice .log file. <br /></td></tr>
<tr class="separator:a1afa7ed5b43a996e0c7487adf39b3c8a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa8925f6d6f65d345cf94a2a7e2cc59cb"><td class="memItemLeft" align="right" valign="top"><a id="aa8925f6d6f65d345cf94a2a7e2cc59cb"></a>
std::vector&lt; <a class="el" href="classsym__op.html">sym_op</a>&lt; LATFLOAT &gt; &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classlattice.html#aa8925f6d6f65d345cf94a2a7e2cc59cb">SYM</a></td></tr>
<tr class="memdesc:aa8925f6d6f65d345cf94a2a7e2cc59cb"><td class="mdescLeft">&#160;</td><td class="mdescRight">Symmetry operations. <br /></td></tr>
<tr class="separator:aa8925f6d6f65d345cf94a2a7e2cc59cb"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae2e7ddc85ceace7df7513b00d6bc1c76"><td class="memItemLeft" align="right" valign="top"><a id="ae2e7ddc85ceace7df7513b00d6bc1c76"></a>
Matrix&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classlattice.html#ae2e7ddc85ceace7df7513b00d6bc1c76">epsilon_0</a></td></tr>
<tr class="memdesc:ae2e7ddc85ceace7df7513b00d6bc1c76"><td class="mdescLeft">&#160;</td><td class="mdescRight">Static epsilon (used for screening) <br /></td></tr>
<tr class="separator:ae2e7ddc85ceace7df7513b00d6bc1c76"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac5d51e5be5ba15ae0bcd10a68463cb3d"><td class="memItemLeft" align="right" valign="top"><a id="ac5d51e5be5ba15ae0bcd10a68463cb3d"></a>
std::vector&lt; Vector &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classlattice.html#ac5d51e5be5ba15ae0bcd10a68463cb3d">RHO</a></td></tr>
<tr class="memdesc:ac5d51e5be5ba15ae0bcd10a68463cb3d"><td class="mdescLeft">&#160;</td><td class="mdescRight">Molecular positions inside the unit cell in orthogonal coordinates. <br /></td></tr>
<tr class="separator:ac5d51e5be5ba15ae0bcd10a68463cb3d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a21c1be32385409ede06a9612319d1075"><td class="memItemLeft" align="right" valign="top"><a id="a21c1be32385409ede06a9612319d1075"></a>
std::vector&lt; Vector &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classlattice.html#a21c1be32385409ede06a9612319d1075">MOL_DIPOLE</a></td></tr>
<tr class="memdesc:a21c1be32385409ede06a9612319d1075"><td class="mdescLeft">&#160;</td><td class="mdescRight">Molecular dipole moments. <br /></td></tr>
<tr class="separator:a21c1be32385409ede06a9612319d1075"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af425d8aa224ac4700cd4d9c7a967e352"><td class="memItemLeft" align="right" valign="top"><a id="af425d8aa224ac4700cd4d9c7a967e352"></a>
std::vector&lt; std::vector&lt; Vector &gt; &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classlattice.html#af425d8aa224ac4700cd4d9c7a967e352">ATOM</a></td></tr>
<tr class="memdesc:af425d8aa224ac4700cd4d9c7a967e352"><td class="mdescLeft">&#160;</td><td class="mdescRight">Atomic positions with respect to the CoM. <br /></td></tr>
<tr class="separator:af425d8aa224ac4700cd4d9c7a967e352"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5beb6a09cf0cdc150d04fb6d9d868664"><td class="memItemLeft" align="right" valign="top"><a id="a5beb6a09cf0cdc150d04fb6d9d868664"></a>
std::vector&lt; std::vector&lt; LATFLOAT &gt; &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classlattice.html#a5beb6a09cf0cdc150d04fb6d9d868664">CHARGE</a></td></tr>
<tr class="memdesc:a5beb6a09cf0cdc150d04fb6d9d868664"><td class="mdescLeft">&#160;</td><td class="mdescRight">Atomic "transition" charges. <br /></td></tr>
<tr class="separator:a5beb6a09cf0cdc150d04fb6d9d868664"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6bdf465bb14f14c1c0b59b20b7498391"><td class="memItemLeft" align="right" valign="top"><a id="a6bdf465bb14f14c1c0b59b20b7498391"></a>
std::vector&lt; Vector &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classlattice.html#a6bdf465bb14f14c1c0b59b20b7498391">CELL</a></td></tr>
<tr class="memdesc:a6bdf465bb14f14c1c0b59b20b7498391"><td class="mdescLeft">&#160;</td><td class="mdescRight">Crystal axes. <br /></td></tr>
<tr class="separator:a6bdf465bb14f14c1c0b59b20b7498391"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae2a2473a93080acad9e79d36cf6bef9a"><td class="memItemLeft" align="right" valign="top"><a id="ae2a2473a93080acad9e79d36cf6bef9a"></a>
std::vector&lt; Vector &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classlattice.html#ae2a2473a93080acad9e79d36cf6bef9a">KCELL</a></td></tr>
<tr class="memdesc:ae2a2473a93080acad9e79d36cf6bef9a"><td class="mdescLeft">&#160;</td><td class="mdescRight">Reciprocal lattice vectors. <br /></td></tr>
<tr class="separator:ae2a2473a93080acad9e79d36cf6bef9a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a25a806422e73002b7663eee80f85f18c"><td class="memItemLeft" align="right" valign="top"><a id="a25a806422e73002b7663eee80f85f18c"></a>
LATFLOAT&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classlattice.html#a25a806422e73002b7663eee80f85f18c">VCELL</a></td></tr>
<tr class="memdesc:a25a806422e73002b7663eee80f85f18c"><td class="mdescLeft">&#160;</td><td class="mdescRight">Cell volume. <br /></td></tr>
<tr class="separator:a25a806422e73002b7663eee80f85f18c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4134fc7e44b97524461180f96191b322"><td class="memItemLeft" align="right" valign="top">std::string&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classlattice.html#a4134fc7e44b97524461180f96191b322">MODE</a></td></tr>
<tr class="memdesc:a4134fc7e44b97524461180f96191b322"><td class="mdescLeft">&#160;</td><td class="mdescRight">Method used to calculate the resonance-interaction matrix.  <a href="#a4134fc7e44b97524461180f96191b322">More...</a><br /></td></tr>
<tr class="separator:a4134fc7e44b97524461180f96191b322"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a87316875e30627a0a4f15f15ff54c215"><td class="memItemLeft" align="right" valign="top">std::string&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classlattice.html#a87316875e30627a0a4f15f15ff54c215">MOL_MOL_INT</a></td></tr>
<tr class="memdesc:a87316875e30627a0a4f15f15ff54c215"><td class="mdescLeft">&#160;</td><td class="mdescRight">Type of interaction "N"= nearest neighbors;.  <a href="#a87316875e30627a0a4f15f15ff54c215">More...</a><br /></td></tr>
<tr class="separator:a87316875e30627a0a4f15f15ff54c215"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3d40c7bd1696baa69d4febbd4f2553a3"><td class="memItemLeft" align="right" valign="top">LATFLOAT&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classlattice.html#a3d40c7bd1696baa69d4febbd4f2553a3">NON_SCR_RADIUS</a></td></tr>
<tr class="memdesc:a3d40c7bd1696baa69d4febbd4f2553a3"><td class="mdescLeft">&#160;</td><td class="mdescRight">Radius beyond which distributed transition charge interactions and dipole interactions are considered screened.  <a href="#a3d40c7bd1696baa69d4febbd4f2553a3">More...</a><br /></td></tr>
<tr class="separator:a3d40c7bd1696baa69d4febbd4f2553a3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa11d0af39592e631b07be6f39efaa770"><td class="memItemLeft" align="right" valign="top">LATFLOAT&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classlattice.html#aa11d0af39592e631b07be6f39efaa770">RMAX</a></td></tr>
<tr class="memdesc:aa11d0af39592e631b07be6f39efaa770"><td class="mdescLeft">&#160;</td><td class="mdescRight">Radius of the sphere (for MODE='F') or circle (for MODE='S') used for finite sum calculations.  <a href="#aa11d0af39592e631b07be6f39efaa770">More...</a><br /></td></tr>
<tr class="separator:aa11d0af39592e631b07be6f39efaa770"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a85d87c5be7223f0e32ea4f905988269e"><td class="memItemLeft" align="right" valign="top">Vector&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classlattice.html#a85d87c5be7223f0e32ea4f905988269e">KLIGHT</a></td></tr>
<tr class="memdesc:a85d87c5be7223f0e32ea4f905988269e"><td class="mdescLeft">&#160;</td><td class="mdescRight">k vector of incident light, used to compute bands at the BZ center  <a href="#a85d87c5be7223f0e32ea4f905988269e">More...</a><br /></td></tr>
<tr class="separator:a85d87c5be7223f0e32ea4f905988269e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a59f183b555ce2904f8f139de1506ba49"><td class="memItemLeft" align="right" valign="top"><a id="a59f183b555ce2904f8f139de1506ba49"></a>
std::vector&lt; std::vector&lt; LATFLOAT &gt; &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classlattice.html#a59f183b555ce2904f8f139de1506ba49">NN_int</a></td></tr>
<tr class="memdesc:a59f183b555ce2904f8f139de1506ba49"><td class="mdescLeft">&#160;</td><td class="mdescRight">Nearest neighbours interactions. <br /></td></tr>
<tr class="separator:a59f183b555ce2904f8f139de1506ba49"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8e7cfa6e1bebbd12c44ae40aac3da3ca"><td class="memItemLeft" align="right" valign="top">std::vector&lt; std::vector&lt; <a class="el" href="structpos.html">pos</a>&lt; LATFLOAT &gt; &gt; &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classlattice.html#a8e7cfa6e1bebbd12c44ae40aac3da3ca">NN</a></td></tr>
<tr class="memdesc:a8e7cfa6e1bebbd12c44ae40aac3da3ca"><td class="mdescLeft">&#160;</td><td class="mdescRight">NN contains the nearest neighbours positions (a 3d vector)  <a href="#a8e7cfa6e1bebbd12c44ae40aac3da3ca">More...</a><br /></td></tr>
<tr class="separator:a8e7cfa6e1bebbd12c44ae40aac3da3ca"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1fafdd4f1244fcca025d2d73988c995b"><td class="memItemLeft" align="right" valign="top"><a id="a1fafdd4f1244fcca025d2d73988c995b"></a>
Matrix&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classlattice.html#a1fafdd4f1244fcca025d2d73988c995b">OtoF</a></td></tr>
<tr class="memdesc:a1fafdd4f1244fcca025d2d73988c995b"><td class="mdescLeft">&#160;</td><td class="mdescRight">Matrix for transformation from Orthogonal to Fractional coordinates. <br /></td></tr>
<tr class="separator:a1fafdd4f1244fcca025d2d73988c995b"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><h3>template&lt;typename LATFLOAT&gt;<br />
class lattice&lt; LATFLOAT &gt;</h3>

<p>Molecular crystal's lattice. </p>
<p>It defines all the properties of the molecular crystal's lattice </p><pre class="fragment"></pre> </div><h2 class="groupheader">Member Function Documentation</h2>
<a id="a5897223ed8d427efd481d88bbcb1bd40"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a5897223ed8d427efd481d88bbcb1bd40">&#9670;&nbsp;</a></span>compute_FE_bands()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename LATFLOAT &gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void <a class="el" href="classlattice.html">lattice</a>&lt; LATFLOAT &gt;::compute_FE_bands </td>
          <td>(</td>
          <td class="paramtype">std::vector&lt; Vector &gt;&#160;</td>
          <td class="paramname"><em>dir</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>npoints</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>n0</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>n1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>n2</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>flag_macro</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Calculates the interaction between transition charge distributions. </p>
<p>rba is the distance between the center of mass of the two molecules </p>

</div>
</div>
<a id="a582cd362b494beccb79b905945b2ed48"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a582cd362b494beccb79b905945b2ed48">&#9670;&nbsp;</a></span>compute_Ltilde()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename LATFLOAT &gt; </div>
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classlattice.html">lattice</a>&lt; LATFLOAT &gt;::Complex <a class="el" href="classlattice.html">lattice</a>&lt; LATFLOAT &gt;::compute_Ltilde </td>
          <td>(</td>
          <td class="paramtype">Vector&#160;</td>
          <td class="paramname"><em>kvec</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>i</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>j</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>flag_macro</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Calculates the resonance-interaction matrix using the method defined by "MODE". </p>
<p>flag_macro is passed to the routine Ewald_sums (if used) </p>

</div>
</div>
<a id="a99707d13ea060f684ca81f1b9eea38c1"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a99707d13ea060f684ca81f1b9eea38c1">&#9670;&nbsp;</a></span>compute_NN()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename LATFLOAT&gt; </div>
      <table class="memname">
        <tr>
          <td class="memname">std::vector&lt; std::vector&lt; <a class="el" href="structpos.html">pos</a>&lt; LATFLOAT &gt; &gt; &gt; <a class="el" href="classlattice.html">lattice</a>&lt; LATFLOAT &gt;::compute_NN </td>
          <td>(</td>
          <td class="paramtype">LATFLOAT&#160;</td>
          <td class="paramname"><em>rmax</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>flag_2D</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Computes the nearest neighbours for each inequivalent molecule. </p>
<p>If flag_2D==1 it considers only NN on the same xy plane This function accesses NN without get_ functions Note: check if it exploits all the symmetry operations </p>

</div>
</div>
<a id="ad3cac006933863ca1733b92af2b12947"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad3cac006933863ca1733b92af2b12947">&#9670;&nbsp;</a></span>distributed_charge_interaction()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename LATFLOAT &gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">LATFLOAT <a class="el" href="classlattice.html">lattice</a>&lt; LATFLOAT &gt;::distributed_charge_interaction </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>alpha</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>beta</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">Vector&#160;</td>
          <td class="paramname"><em>rba</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Calculates the screened interaction between transition charge distributions. </p>
<p>rba is the distance between the center of mass of the two molecules e00, e11, e22 are the three diagonal components of the screening dielectric tensor (the non-diagonal components are ignored) </p>

</div>
</div>
<a id="ae5f2cf7f125b68ad18c7c952abbe22c1"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae5f2cf7f125b68ad18c7c952abbe22c1">&#9670;&nbsp;</a></span>Finite_sums()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename LATFLOAT &gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classlattice.html">lattice</a>&lt; LATFLOAT &gt;::Complex <a class="el" href="classlattice.html">lattice</a>&lt; LATFLOAT &gt;::Finite_sums </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>flag_2D</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">Vector&#160;</td>
          <td class="paramname"><em>k</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>alpha</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>beta</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Calculates the correction to Ewald sums due to transition charge distributions replacing single dipoles. </p>
<p>Used when MODE='M' Note: this routine DOES NOT exploit inversion symmetry </p>

</div>
</div>
<a id="a93bf7ce0cf1817549be7748c839e1348"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a93bf7ce0cf1817549be7748c839e1348">&#9670;&nbsp;</a></span>initialize()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename LATFLOAT&gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void <a class="el" href="classlattice.html">lattice</a>&lt; LATFLOAT &gt;::initialize </td>
          <td>(</td>
          <td class="paramtype">std::string&#160;</td>
          <td class="paramname"><em>input_file</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Calculates the resonance interaction matrix using Ewald sums. </p>
<p>Returns energy in eV provided distances are in A and dipoles in Debye The long-wavelength term is included only if macro_flag!=0 This is the default function used when MODE is not explicitly set to 'F', 'S' or 'M' Note: check screening! </p>

</div>
</div>
<a id="a0336e996d2d52e3fae5c759adab486e1"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0336e996d2d52e3fae5c759adab486e1">&#9670;&nbsp;</a></span>interaction() <span class="overload">[1/2]</span></h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename LATFLOAT &gt; </div>
      <table class="memname">
        <tr>
          <td class="memname">LATFLOAT <a class="el" href="classlattice.html">lattice</a>&lt; LATFLOAT &gt;::interaction </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>alpha</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>beta</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">Vector&#160;</td>
          <td class="paramname"><em>dr</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Calculates the interaction between molecules of type alpha and beta at a distance dr (3D vector) </p>
<p>Using the type of interaction defined by "MOL_MOL_INT" </p>

</div>
</div>
<a id="afc681f628f7d71a76dc260133d00974f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#afc681f628f7d71a76dc260133d00974f">&#9670;&nbsp;</a></span>interaction() <span class="overload">[2/2]</span></h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename LATFLOAT &gt; </div>
      <table class="memname">
        <tr>
          <td class="memname">LATFLOAT <a class="el" href="classlattice.html">lattice</a>&lt; LATFLOAT &gt;::interaction </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>alpha</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>nn</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Calculates the interaction between a molecule of type alpha and its nn-th nearest neighboour. </p>
<p>Using the type of interaction defined by "MOL_MOL_INT" </p>

</div>
</div>
<h2 class="groupheader">Member Data Documentation</h2>
<a id="a85d87c5be7223f0e32ea4f905988269e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a85d87c5be7223f0e32ea4f905988269e">&#9670;&nbsp;</a></span>KLIGHT</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename LATFLOAT&gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">Vector <a class="el" href="classlattice.html">lattice</a>&lt; LATFLOAT &gt;::KLIGHT</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>k vector of incident light, used to compute bands at the BZ center </p>
<p>in the 3D grid mode, corresponds to hw = |KLIGHT|*1970 </p>

</div>
</div>
<a id="a4134fc7e44b97524461180f96191b322"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a4134fc7e44b97524461180f96191b322">&#9670;&nbsp;</a></span>MODE</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename LATFLOAT&gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">std::string <a class="el" href="classlattice.html">lattice</a>&lt; LATFLOAT &gt;::MODE</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Method used to calculate the resonance-interaction matrix. </p>
<p>Case 'F' -&gt; Finite_sums; case 'S' -&gt; Single_layer_sums; 'M'-&gt; Mixed finite charge dist + Ewald; default -&gt; Ewald_sums </p>

</div>
</div>
<a id="a87316875e30627a0a4f15f15ff54c215"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a87316875e30627a0a4f15f15ff54c215">&#9670;&nbsp;</a></span>MOL_MOL_INT</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename LATFLOAT&gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">std::string <a class="el" href="classlattice.html">lattice</a>&lt; LATFLOAT &gt;::MOL_MOL_INT</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Type of interaction "N"= nearest neighbors;. </p>
<p>"T"=screend distributed transition charge; default=screened_dipole; </p>

</div>
</div>
<a id="a8e7cfa6e1bebbd12c44ae40aac3da3ca"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a8e7cfa6e1bebbd12c44ae40aac3da3ca">&#9670;&nbsp;</a></span>NN</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename LATFLOAT&gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">std::vector&lt;std::vector&lt;<a class="el" href="structpos.html">pos</a>&lt;LATFLOAT&gt; &gt; &gt; <a class="el" href="classlattice.html">lattice</a>&lt; LATFLOAT &gt;::NN</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>NN contains the nearest neighbours positions (a 3d vector) </p>
<p>for each type of molecule (1st index) and each neighbour (2nd index) </p>

</div>
</div>
<a id="a3d40c7bd1696baa69d4febbd4f2553a3"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3d40c7bd1696baa69d4febbd4f2553a3">&#9670;&nbsp;</a></span>NON_SCR_RADIUS</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename LATFLOAT&gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">LATFLOAT <a class="el" href="classlattice.html">lattice</a>&lt; LATFLOAT &gt;::NON_SCR_RADIUS</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Radius beyond which distributed transition charge interactions and dipole interactions are considered screened. </p>
<p>(set it to 0 to always screen interactions and very large to disregard screening) </p>

</div>
</div>
<a id="aa11d0af39592e631b07be6f39efaa770"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa11d0af39592e631b07be6f39efaa770">&#9670;&nbsp;</a></span>RMAX</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename LATFLOAT&gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">LATFLOAT <a class="el" href="classlattice.html">lattice</a>&lt; LATFLOAT &gt;::RMAX</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Radius of the sphere (for MODE='F') or circle (for MODE='S') used for finite sum calculations. </p>
<p>Also used for MODE='M' to calculate corrections to Ewald sums due to finite charge distribution </p>

</div>
</div>
<hr/>The documentation for this class was generated from the following files:<ul>
<li>src/<a class="el" href="lattice_8h_source.html">lattice.h</a></li>
<li>src/lattice.cpp</li>
<li>src/latticetest.cpp</li>
</ul>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.15
</small></address>
</body>
</html>
